<!-- templates/index.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Spotify Database Manager</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" /> 
</head>
<body>
    <h1><span style="color:#1db954">Spotify</span> Database Manager</h1>

    <!-- Section for Authenticated Users -->
    {% if not playlists %}
        <h2 style="color:#b3b3b3">Authenticated Users</h2>
        {% if users %}
            <ul>
                {% for user_id, display_name in users %}
                    <li>
                        {{ display_name }} 
                        <a href="{{ url_for('select_user', spotify_user_id=user_id) }}">View Playlists</a>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No users authenticated yet.</p>
        {% endif %}
        <a href="{{ url_for('login') }}">Log in with Spotify</a>
    {% else %}
        <!-- Section for Playlists of Selected User -->
        <h2 style="color:#b3b3b3">Playlists for User: {{ user_id }}</h2>
        <ul>
            {% for playlist in playlists %}
                <li>
                    {{ playlist['name'] }}
                    <!-- Add data-id attributes for both buttons -->
                    <button class="view-tracks-btn" data-id="{{ playlist['id'] }}">View Tracks</button>
                    <button class="save-to-db-btn" data-id="{{ playlist['id'] }}">Save to Database</button>
                </li>
            {% endfor %}
        </ul>
        <a href="{{ url_for('index') }}">Back to Users</a>

        <!-- Modal Structure -->
        <div id="playlistModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal()">&times;</span>
                <h2>Playlist Tracks</h2>
                <table id="trackTable" border="1">
                    <tr>
                        <th>Track Name</th>
                        <th>Artist</th>
                        <th>Album</th>
                        <th>URI</th>
                    </tr>
                </table>
            </div>
        </div>
    {% endif %}

    <script src="{{ url_for('static', filename='jv.js') }}"></script>
</body>
</html>
